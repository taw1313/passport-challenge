const db = require('../models/factories')

//
//
// ToDo:  Add object key and value validation
//
//

module.exports = {
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    createFactory: (req, res) => {
        const io = req.app.get('socketio')
        db.createFactory( req.body ) 
            .then( (data) => {
                io.sockets.emit('get_all_data')
                res.json(data) 
            })
            .catch( (err) => res.status(422).json(err) )
    },
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    getAllFactories: (req, res) => {
        const io = req.app.get('socketio')
        db.readAllFactories()
            .then( (data) => {
                io.sockets.emit('get_all_data')
                res.json(data) 
            })
            .catch( (err) => res.status(422).json(err) )

    },
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    updateFactory: (req, res) => {
        const io = req.app.get('socketio')
        db.updateFactory( req.params, req.body )
            .then( (data) => {
                io.sockets.emit('get_all_data')
                res.json(data) 
            })
           .catch( (err) => res.status(422).json(err) )

    },
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    getFactory: (req, res) => {
        const io = req.app.get('socketio')
        db.readFactory( req.params )
            .then( (data) => {
                io.sockets.emit('get_all_data')
                res.json(data) 
            })
            .catch( (err) => res.status(422).json(err) )

    },
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    delFactory: (req, res) => {
        const io = req.app.get('socketio')
        db.deleteFactory( req.params, req.body )
            .then( (data) => {
               io.sockets.emit('get_all_data')
               res.json(data) 
            })
           .catch( (err) => res.status(422).json(err) )
    }
}